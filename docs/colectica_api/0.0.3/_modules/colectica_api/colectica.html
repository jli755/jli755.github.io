<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>colectica_api.colectica &mdash; Colectica-API 0.0.3 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Colectica-API
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module.html"><code class="docutils literal notranslate"><span class="pre">colectica_api</span></code> module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Colectica-API</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">colectica_api.colectica</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for colectica_api.colectica</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pull information using python ColecticaPortal api</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">from</span> <span class="nn">.api</span> <span class="kn">import</span> <span class="n">ColecticaBasicAPI</span>


<span class="k">def</span> <span class="nf">remove_xml_ns</span><span class="p">(</span><span class="n">xml</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read xml from string, remove namespaces, return root</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">it</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">iterparse</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">xml</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="n">prefix</span><span class="p">,</span> <span class="n">has_namespace</span><span class="p">,</span> <span class="n">postfix</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_namespace</span><span class="p">:</span>
            <span class="n">el</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="n">postfix</span>  <span class="c1"># strip all namespaces</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">root</span>
    <span class="k">return</span> <span class="n">root</span>


<span class="k">def</span> <span class="nf">root_to_dict_study</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Study</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="c1"># custom filed</span>
    <span class="n">CustomFields</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//UserAttributePair/AttributeValue&#39;</span><span class="p">)</span>
    <span class="n">custom_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">cus</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">CustomFields</span><span class="p">):</span>
        <span class="c1"># Convert a string representation of a dictionary to a dictionary</span>
        <span class="n">custom_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">cus</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;custom_field&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">custom_list</span>

    <span class="c1"># Citation</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">citation</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Title/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/AlternateTitle/String&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">citation</span><span class="p">[</span><span class="s1">&#39;alternate_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/AlternateTitle/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">citation</span><span class="p">[</span><span class="s1">&#39;creator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Creator/CreatorName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Publisher&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">citation</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Publisher/PublisherName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">citation</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">citation</span>

    <span class="c1"># Abstract</span>
    <span class="n">abstract</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">abstract</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Abstract/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Abstract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">abstract</span>

    <span class="c1"># UniverseReference</span>
    <span class="n">universe_reference</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">universe_reference</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">universe_reference</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">universe_reference</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">universe_reference</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UniverseReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">universe_reference</span>

    <span class="c1"># Funding</span>
    <span class="n">funding_all</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//FundingInformation&#39;</span><span class="p">)</span>
    <span class="n">funding_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">funding</span> <span class="ow">in</span> <span class="n">funding_all</span><span class="p">:</span>
        <span class="n">organization</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">funding</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AgencyOrganizationReference/Agency&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">organization</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funding</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AgencyOrganizationReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">funding</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AgencyOrganizationReference/ID&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">organization</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funding</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AgencyOrganizationReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">funding</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AgencyOrganizationReference/Version&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">organization</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funding</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AgencyOrganizationReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">funding</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AgencyOrganizationReference/TypeOfObject&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">organization</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funding</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AgencyOrganizationReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">funding_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">organization</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;FundingInformation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funding_list</span>

    <span class="c1"># Coverage</span>
    <span class="n">coverage</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">spatial_coverage</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">temporal_coverage</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">spatial_coverage</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">spatial_coverage</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">spatial_coverage</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">spatial_coverage</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/BoundingBox&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bouding_box</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">bouding_box</span><span class="p">[</span><span class="s1">&#39;WestLongitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/BoundingBox/WestLongitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">bouding_box</span><span class="p">[</span><span class="s1">&#39;EastLongitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/BoundingBox/EastLongitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">bouding_box</span><span class="p">[</span><span class="s1">&#39;SouthLatitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/BoundingBox/SouthLatitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">bouding_box</span><span class="p">[</span><span class="s1">&#39;NorthLatitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/BoundingBox/NorthLatitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">spatial_coverage</span><span class="p">[</span><span class="s1">&#39;BoundingBox&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bouding_box</span>
            <span class="n">country_all</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/Country&#39;</span><span class="p">)</span>
            <span class="n">spatial_coverage</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">country_all</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/TopLevelReference&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">top_ref</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">top_ref</span><span class="p">[</span><span class="s1">&#39;LevelName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/TopLevelReference/LevelName&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">spatial_coverage</span><span class="p">[</span><span class="s1">&#39;TopLevelReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_ref</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/LowestLevelReference&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">low_ref</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">low_ref</span><span class="p">[</span><span class="s1">&#39;LevelName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/SpatialCoverage/LowestLevelReference/LevelName&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">spatial_coverage</span><span class="p">[</span><span class="s1">&#39;LowestLevelReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">low_ref</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">temporal_coverage</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">temporal_coverage</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">temporal_coverage</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">temporal_coverage</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/ReferenceDate&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ref_date</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/ReferenceDate/SimpleDate&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ref_date</span><span class="p">[</span><span class="s1">&#39;SimpleDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/ReferenceDate/SimpleDate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/ReferenceDate/StartDate&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ref_date</span><span class="p">[</span><span class="s1">&#39;StartDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/ReferenceDate/StartDate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/ReferenceDate/EndDate&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ref_date</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Coverage/TemporalCoverage/ReferenceDate/EndDate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">temporal_coverage</span><span class="p">[</span><span class="s1">&#39;ReferenceDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_date</span>
    <span class="n">coverage</span><span class="p">[</span><span class="s1">&#39;SpatialCoverage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spatial_coverage</span>
    <span class="n">coverage</span><span class="p">[</span><span class="s1">&#39;TemporalCoverage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temporal_coverage</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Coverage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coverage</span>

    <span class="c1"># Data</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//KindOfData&#39;</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;KindOfData&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">k</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Analysis Unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AnalysisUnit&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="c1"># data files</span>
    <span class="n">datafile</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstanceReference&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstanceReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstanceReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstanceReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstanceReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;PhysicalInstanceReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datafile</span>

    <span class="c1"># data collection</span>
    <span class="n">datacol</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">datacol</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//DataCollectionReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">datacol</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//DataCollectionReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">datacol</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//DataCollectionReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">datacol</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//DataCollectionReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Data Collection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datacol</span>

    <span class="c1"># Extra</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//RequiredResourcePackages/ResourcePackageReference&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//RequiredResourcePackages/ResourcePackageReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//RequiredResourcePackages/ResourcePackageReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//RequiredResourcePackages/ResourcePackageReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//RequiredResourcePackages/ResourcePackageReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ResourcePackageReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_series</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="c1"># Study Description</span>
    <span class="n">study</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">study</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Title/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">study</span><span class="p">[</span><span class="s1">&#39;principal_investigator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Creator/CreatorName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">study</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Publisher/PublisherName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">study</span><span class="p">[</span><span class="s1">&#39;rights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Copyright/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">study</span><span class="p">[</span><span class="s1">&#39;abstract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Abstract/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">pop</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">pop</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">pop</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">pop</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UniverseReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">study</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;study&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">study</span>
    <span class="c1"># Funding</span>
    <span class="n">funding</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//FundingInformation/GrantNumber&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">funding</span><span class="p">[</span><span class="s1">&#39;GrantNumber&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//FundingInformation/GrantNumber&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">organization</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">organization</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//FundingInformation/AgencyOrganizationReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">organization</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//FundingInformation/AgencyOrganizationReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">organization</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//FundingInformation/AgencyOrganizationReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">organization</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//FundingInformation/AgencyOrganizationReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">funding</span><span class="p">[</span><span class="s1">&#39;organization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">organization</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;funding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funding</span>
    <span class="c1"># Studies</span>
    <span class="n">studies</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//StudyUnitReference&#39;</span><span class="p">)</span>
    <span class="n">study_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">study</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">studies</span><span class="p">):</span>
        <span class="n">study_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">study_dict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">study_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">study_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">study_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">study_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">study_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">study_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;study&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">study_list</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_metadata_package</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Data Collection</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([[</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;typeOfUserID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="o">.</span><span class="n">text</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)])</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VersionResponsibility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VersionResponsibility&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VersionRationale&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VersionRationale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VersionRationale/RationaleDescription/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Citation/Title/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Purpose&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Purpose/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="c1"># InterviewerInstructionSchemeReference</span>
    <span class="n">instruction_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">instruction_ref</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//InterviewerInstructionSchemeReference&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">instruction_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">instruction_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instruction_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">instruction_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instruction_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">instruction_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instruction_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">instruction_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instruction_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InterviewerInstructionSchemeReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instruction_dict</span>

    <span class="c1"># ControlConstructSchemeReference</span>
    <span class="n">cc_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cc_ref</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ControlConstructSchemeReference&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">instruction_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cc_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cc_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">cc_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cc_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">cc_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cc_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">cc_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cc_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ControlConstructSchemeReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cc_dict</span>

    <span class="c1"># QuestionSchemeReference</span>
    <span class="n">question_all</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//QuestionSchemeReference&#39;</span><span class="p">)</span>
    <span class="n">question_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">question</span> <span class="ow">in</span> <span class="n">question_all</span><span class="p">:</span>
        <span class="n">question_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">question_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">question_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionSchemeReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_list</span>

    <span class="c1"># CategorySchemeReference</span>
    <span class="n">category_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">category_ref</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CategorySchemeReference&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">instruction_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">category_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">category_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">category_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">category_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;CategorySchemeReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category_dict</span>

    <span class="c1"># CodeListSchemeReference</span>
    <span class="n">code_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">code_ref</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CodeListSchemeReference&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">instruction_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;CodeListSchemeReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_dict</span>

    <span class="c1"># InstrumentSchemeReference</span>
    <span class="n">instrument_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">instrument_ref</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//InstrumentSchemeReference&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">instruction_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">instrument_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">instrument_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">instrument_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">instrument_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InstrumentSchemeReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_dict</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_data_collection</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Data Collection</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//DataCollectionModuleName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="c1"># InstrumentRef</span>
    <span class="n">cus_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cus</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//UserAttributePair&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">cus</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AttributeKey&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AttributeValue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">cus_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Ref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cus_dict</span>

    <span class="c1"># CollectionEvent</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">event</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CollectionEvent/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">event</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CollectionEvent/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">event</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CollectionEvent/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">event</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CollectionEvent/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="c1"># Organization Reference</span>
    <span class="n">organization_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">organization_all</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//CollectionEvent/DataCollectorOrganizationReference&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">organization</span> <span class="ow">in</span> <span class="n">organization_all</span><span class="p">:</span>
        <span class="n">OrganizationRef</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">OrganizationRef</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">organization</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">OrganizationRef</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">organization</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">OrganizationRef</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">organization</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">OrganizationRef</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">organization</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">event</span><span class="p">[</span><span class="s1">&#39;OrganizationRef&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">organization_list</span>

    <span class="c1"># Data Collection Date</span>
    <span class="n">DCDate</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CollectionEvent/DataCollectionDate&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">date</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//StartDate&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">DCDate</span><span class="p">[</span><span class="s1">&#39;StartDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//StartDate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">date</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//EndDate&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">DCDate</span><span class="p">[</span><span class="s1">&#39;EndDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//EndDate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">date</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//SimpleDate&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">DCDate</span><span class="p">[</span><span class="s1">&#39;SimpleDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//SimpleDate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">event</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DCDate</span>
    <span class="c1"># Mode Of Collection</span>
    <span class="n">mode_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mode_all</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//CollectionEvent/ModeOfCollection&#39;</span><span class="p">)</span>
    <span class="c1"># list multiple types</span>
    <span class="k">for</span> <span class="n">type_mode</span> <span class="ow">in</span> <span class="n">mode_all</span><span class="p">:</span>
        <span class="n">mode_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">mode_dict</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_mode</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;./URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">mode_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_mode</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;./Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">mode_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_mode</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;./ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">mode_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_mode</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;./Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">mode_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfMode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_mode</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;./TypeOfModeOfCollection&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">mode_dict</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_mode</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;./Description/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">mode_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode_dict</span><span class="p">)</span>
    <span class="n">event</span><span class="p">[</span><span class="s1">&#39;ModeOfCollection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode_list</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;CollectionEvent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event</span>
    <span class="c1"># Question Scheme Reference</span>
    <span class="n">QSR</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionSchemeReference&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">QSR</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionSchemeReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">QSR</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionSchemeReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">QSR</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionSchemeReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">QSR</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionSchemeReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;reference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QSR</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_sequence</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;SourceId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;SourceId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ConstructName/String&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConstructName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ConstructName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConstructName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">references</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//ControlConstructReference&quot;</span><span class="p">)</span>
    <span class="n">ref_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">references</span><span class="p">):</span>
        <span class="n">ref_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_list</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_statement</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Statement</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;StatementURN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;SourceId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">instruction</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//UserAttributePair/AttributeValue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="n">instruction</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Instruction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Instruction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instruction</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ConstructName/String&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Literal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//DisplayText/LiteralText/Text&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_organization</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Organization</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="c1"># Nickname</span>
    <span class="n">cus_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cus</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//UserAttributePair&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">cus</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AttributeKey&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AttributeValue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">cus_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;cust&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cus_dict</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//OrganizationIdentification/OrganizationName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Image&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//OrganizationIdentification/OrganizationImage/ImageLocation&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Description/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_instrument</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Instrument</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InstrumentURN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//*[@typeOfUserID=&#39;colectica:sourceId&#39;]&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InstrumentSourceID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//*[@typeOfUserID=&#39;colectica:sourceId&#39;]&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//*[@typeOfUserID=&#39;closer:sourceFileName&#39;]&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InstrumentLabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//*[@typeOfUserID=&#39;closer:sourceFileName&#39;]&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InstrumentName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//InstrumentName/String&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ExternalInstrumentLocation&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ExternalInstrumentLocation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ExternalInstrumentLocation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ExternalInstrumentLocation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">references</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//ControlConstructReference&quot;</span><span class="p">)</span>
    <span class="n">ref_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">references</span><span class="p">):</span>
        <span class="n">ref_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_list</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_question_group</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Question Group</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionGroupName/String&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionGroupName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Concept Reference</span>
    <span class="n">ConceptRef</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//ConceptReference&#39;</span><span class="p">)</span>

    <span class="n">ConceptRef_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ConceptRef</span><span class="p">):</span>
        <span class="n">ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ConceptRef_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConceptRef&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ConceptRef_list</span>
    <span class="c1"># Question Item Reference</span>
    <span class="n">QuestionItemRef</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//QuestionItemReference&quot;</span><span class="p">)</span>
    <span class="n">QIref_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">QuestionItemRef</span><span class="p">):</span>
        <span class="n">ref_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">QIref_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionItemRef&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QIref_list</span>
    <span class="c1"># Question Group Reference</span>
    <span class="n">QuestionGroupRef</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//QuestionGroupReference&quot;</span><span class="p">)</span>
    <span class="n">QGref_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">QuestionGroupRef</span><span class="p">):</span>
        <span class="n">ref_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">QGref_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionGroupRef&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QGref_list</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_concept</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Concept</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConceptName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ConceptName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">SubclassOfReference</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//SubclassOfReference&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">SubclassOfReference</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//SubclassOfReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">SubclassOfReference</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//SubclassOfReference/ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">SubclassOfReference</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//SubclassOfReference/Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">SubclassOfReference</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//SubclassOfReference/TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;SubclassOfReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubclassOfReference</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_concept_set</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Concept Set</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;CustomField&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//UserAttributePair/AttributeValue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="c1">#TODO</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VersionResponsibility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VersionResponsibility&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VersionRationale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VersionRationale/RationaleDescription/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConceptSchemeName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ConceptSchemeName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Description/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="c1"># Concept Reference</span>
    <span class="n">ConceptReference</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//ConceptReference&quot;</span><span class="p">)</span>
    <span class="n">conceptref_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ConceptReference</span><span class="p">):</span>
        <span class="n">ref_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">conceptref_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConceptReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">conceptref_list</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_interviewer_instruction</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Interviewer Instruction</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InstructionURN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InstructionText&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//InstructionText/LiteralText/Text&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_question</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Question</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionUserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">QLabel</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserAttributePair/AttributeValue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionLabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">QLabel</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionItemName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//QuestionItemName/String&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//QuestionText/LiteralText/Text&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionLiteral&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//QuestionText/LiteralText/Text&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionLiteral&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># ResponseCardinality</span>
    <span class="n">cardinality</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ResponseCardinality&#39;</span><span class="p">)</span>
    <span class="n">car_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">car_dict</span><span class="p">[</span><span class="s1">&#39;minimumResponses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardinality</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;minimumResponses&#39;</span><span class="p">]</span>
    <span class="n">car_dict</span><span class="p">[</span><span class="s1">&#39;maximumResponses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardinality</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;maximumResponses&#39;</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ResponseCardinality&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">car_dict</span>
    <span class="c1"># response</span>
    <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">CodeDomain</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//CodeDomain&quot;</span><span class="p">)</span>
    <span class="n">TextDomain</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TextDomain&quot;</span><span class="p">)</span>
    <span class="n">NumericDomain</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumericDomain&quot;</span><span class="p">)</span>
    <span class="n">DateTimeDomain</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//DateTimeDomain&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">CodeDomain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CodeList&#39;</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;CodeList_Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CodeListReference/Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;CodeList_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CodeDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//CodeListReference/ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;CodeList_version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CodeDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//CodeListReference/Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;code_list_URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;urn:ddi&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;CodeList_Agency&#39;</span><span class="p">],</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;CodeList_ID&#39;</span><span class="p">],</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;CodeList_version&#39;</span><span class="p">]])</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">TextDomain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Text&#39;</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TextDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Label/Content&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">NumericDomain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Numeric&#39;</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Label&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_NumericType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumericTypeCode&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumberRange/Low&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_RangeLow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumberRange/Low&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_RangeLow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumberRange/High&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_RangeHigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumberRange/High&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_RangeHigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">DateTimeDomain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;DateTime&#39;</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;DateTypeCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DateTimeDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//DateTypeCode&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;response_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DateTimeDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Label/Content&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">response</span>

    <span class="c1"># InterviewerInstructionReference</span>
    <span class="n">inst_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">InstructionRef</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//InterviewerInstructionReference&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">InstructionRef</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">inst_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InstructionRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">inst_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InstructionRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">inst_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InstructionRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">inst_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InstructionRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Instruction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inst_dict</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_question_grid</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Question Grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionGridURN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionGridUserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionGridLabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//UserAttributePair/AttributeValue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionGridName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionGridName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionGridLiteral&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionText/LiteralText/Text&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="c1"># GridDimension</span>
    <span class="n">GridDimension</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//GridDimension&#39;</span><span class="p">)</span>
    <span class="n">grid_dimension_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">GridDimension</span><span class="p">):</span>
        <span class="n">dim_dict</span> <span class="o">=</span>  <span class="p">{}</span>
        <span class="n">dim_dict</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dim</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span>
        <span class="n">ResponseCardinality</span> <span class="o">=</span> <span class="n">dim</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CodeDomain/ResponseCardinality&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ResponseCardinality</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dim_dict</span><span class="p">[</span><span class="s1">&#39;minimumResponses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResponseCardinality</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;minimumResponses&#39;</span><span class="p">]</span>
            <span class="n">dim_dict</span><span class="p">[</span><span class="s1">&#39;maximumResponses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResponseCardinality</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;maximumResponses&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dim_dict</span><span class="p">[</span><span class="s1">&#39;minimumResponses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">dim_dict</span><span class="p">[</span><span class="s1">&#39;maximumResponses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">code_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">code_ref</span> <span class="o">=</span> <span class="n">dim</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CodeDomain/CodeListReference&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">code_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">code_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">code_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">code_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">code_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">dim_dict</span><span class="p">[</span><span class="s1">&#39;CodeListReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref_dict</span>

        <span class="n">Roster_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Roster</span> <span class="o">=</span> <span class="n">dim</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Roster&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Roster</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Roster_dict</span><span class="p">[</span><span class="s1">&#39;baseCodeValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Roster</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;baseCodeValue&#39;</span><span class="p">]</span>
            <span class="n">Roster_dict</span><span class="p">[</span><span class="s1">&#39;codeIterationValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Roster</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;codeIterationValue&#39;</span><span class="p">]</span>
            <span class="n">Roster_dict</span><span class="p">[</span><span class="s1">&#39;minimumRequired&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Roster</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;minimumRequired&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Roster</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">Roster_dict</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Roster</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Roster_dict</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">dim_dict</span><span class="p">[</span><span class="s1">&#39;Roster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Roster_dict</span>

        <span class="n">grid_dimension_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dim_dict</span><span class="p">)</span>

    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;GridDimension&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid_dimension_list</span>

    <span class="n">num_domain_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">NumericDomain</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//NumericDomain&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">NumericDomain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_domain_dict</span><span class="p">[</span><span class="s1">&#39;NumericTypeCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumericTypeCode&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">num_domain_dict</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Label/Content&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">NumericDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumberRange/Low&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">num_domain_dict</span><span class="p">[</span><span class="s1">&#39;NumberRangeLow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumberRange/Low&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_domain_dict</span><span class="p">[</span><span class="s1">&#39;NumberRangeLow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">NumericDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumberRange/High&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">num_domain_dict</span><span class="p">[</span><span class="s1">&#39;NumberRangeHigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NumericDomain</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//NumberRange/High&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_domain_dict</span><span class="p">[</span><span class="s1">&#39;NumberRangeHigh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;NumericDomain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_domain_dict</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_code_set</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Code Set</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Codes</span>
    <span class="n">codes</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//Code&#39;</span><span class="p">)</span>
    <span class="n">code_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">code</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">codes</span><span class="p">):</span>
        <span class="n">code_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

        <span class="n">cat_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">cat</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;CategoryReference&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cat_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">cat_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">cat_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">cat_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_dict</span><span class="p">[</span><span class="s1">&#39;CategoryReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat_ref_dict</span>
        <span class="n">code_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_list</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_category</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Category</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CategoryName/String&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CategoryName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_question_activity</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Question Activity</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionConstruct/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionConstruct/UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConstructName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionConstruct/ConstructName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionConstruct/Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ResponseUnit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionConstruct/ResponseUnit&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="c1"># QuestionReference</span>
    <span class="n">QuestionReference</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//QuestionConstruct/QuestionReference&#39;</span><span class="p">)</span>
    <span class="n">question_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">QuestionReference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">question_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuestionReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuestionReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuestionReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuestionReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_ref_dict</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_variable_group</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Variable Group</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VariableGroup/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VariableGroupName/String&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VariableGroupName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VariableGroupName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VariableGroupName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VariableGroup/Label/Content&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//VariableGroup/Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># VariableGroupReference</span>
    <span class="n">VariableGroupReference</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//VariableGroup/VariableGroupReference&#39;</span><span class="p">)</span>
    <span class="n">VG_ref_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">VG_Ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">VariableGroupReference</span><span class="p">):</span>
        <span class="n">VG_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">VG_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VG_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">VG_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VG_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">VG_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VG_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">VG_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VG_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">VG_ref_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VG_ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VariableGroupReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VG_ref_list</span>

    <span class="c1"># ConceptReference</span>
    <span class="n">ConceptReference</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//VariableGroup/ConceptReference&#39;</span><span class="p">)</span>
    <span class="n">concept_ref_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">concept_Ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ConceptReference</span><span class="p">):</span>
        <span class="n">concept_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">concept_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">concept_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">concept_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">concept_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">concept_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">concept_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">concept_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">concept_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">concept_ref_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">concept_ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConceptReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">concept_ref_list</span>

    <span class="c1"># VariableReference</span>
    <span class="n">VariableReference</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//VariableGroup/VariableReference&#39;</span><span class="p">)</span>
    <span class="n">variable_ref_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">variable_Ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">VariableReference</span><span class="p">):</span>
        <span class="n">variable_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">variable_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">variable_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">variable_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">variable_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable_Ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">variable_ref_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">variable_ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VariableReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable_ref_list</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_variable</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Variable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Variable/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Variable/UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VariableName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Variable/VariableName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Variable/Label/Content&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Variable/Label/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># QuestionReference</span>
    <span class="n">QuestionReference</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Variable/QuestionReference&#39;</span><span class="p">)</span>
    <span class="n">question_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">QuestionReference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">question_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuestionReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuestionReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuestionReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">question_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QuestionReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;QuestionReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_ref_dict</span>

    <span class="c1"># VariableRepresentation/CodeRepresentation</span>
    <span class="n">CodeRepresentation</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Variable/VariableRepresentation/CodeRepresentation&#39;</span><span class="p">)</span>
    <span class="n">code_rep_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">CodeRepresentation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">code_rep_dict</span><span class="p">[</span><span class="s1">&#39;RecommendedDataType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CodeRepresentation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//RecommendedDataType&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="c1"># CodeListReference</span>
        <span class="n">code_ref</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">CodeListReference</span> <span class="o">=</span> <span class="n">CodeRepresentation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CodeListReference&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">CodeListReference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">code_ref</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CodeListReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">code_ref</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CodeListReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">code_ref</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CodeListReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">code_rep_dict</span><span class="p">[</span><span class="s1">&#39;CodeListReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_ref</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;CodeRepresentation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_rep_dict</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_conditional</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Conditional</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//IfThenElse/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//IfThenElse/UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConstructName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//IfThenElse/ConstructName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="n">IfCondition</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//IfThenElse/IfCondition&#39;</span><span class="p">)</span>
    <span class="n">ifcondition_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">IfCondition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ifcondition_dict</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">IfCondition</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Description/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ifcondition_dict</span><span class="p">[</span><span class="s1">&#39;ProgramLanguage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">IfCondition</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Command/ProgramLanguage&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ifcondition_dict</span><span class="p">[</span><span class="s1">&#39;CommandContent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">IfCondition</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Command/CommandContent&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;IfCondition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ifcondition_dict</span>

    <span class="c1"># ThenConstructReference</span>
    <span class="n">ThenReference</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//ThenConstructReference&#39;</span><span class="p">)</span>
    <span class="n">then_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">ThenRef</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ThenReference</span><span class="p">):</span>
        <span class="n">then_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">then_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ThenRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">then_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ThenRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">then_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ThenRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">then_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ThenRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">then_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">then_ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;IfThenReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">then_list</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_loop</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Loop</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Loop/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Loop/UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ConstructName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Loop/ConstructName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="n">InitialValue</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Loop/InitialValue&#39;</span><span class="p">)</span>
    <span class="n">InitialValue_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">InitialValue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">InitialValue_dict</span><span class="p">[</span><span class="s1">&#39;ProgramLanguage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InitialValue</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Command/ProgramLanguage&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">InitialValue_dict</span><span class="p">[</span><span class="s1">&#39;CommandContent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InitialValue</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Command/CommandContent&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;InitialValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InitialValue_dict</span>

    <span class="n">LoopWhile</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Loop/LoopWhile&#39;</span><span class="p">)</span>
    <span class="n">LoopWhile_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">LoopWhile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">LoopWhile_dict</span><span class="p">[</span><span class="s1">&#39;ProgramLanguage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LoopWhile</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Command/ProgramLanguage&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">LoopWhile_dict</span><span class="p">[</span><span class="s1">&#39;CommandContent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LoopWhile</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Command/CommandContent&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;LoopWhile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LoopWhile_dict</span>

    <span class="c1">#TODO StepValue</span>
    <span class="n">StepValue</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Loop/StepValue&#39;</span><span class="p">)</span>
    <span class="n">StepValue_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">StepValue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TODO StepValue&#39;</span><span class="p">)</span>

    <span class="c1"># ControlConstructReference</span>
    <span class="n">CCReference</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Loop/ControlConstructReference&#39;</span><span class="p">)</span>
    <span class="n">cc_ref_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">CCReference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cc_ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CCReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">cc_ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CCReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">cc_ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CCReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">cc_ref_dict</span><span class="p">[</span><span class="s1">&#39;TypeOfObject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CCReference</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ControlConstructReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cc_ref_dict</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">root_to_dict_data_file</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Part of parse xml, item_type = Data File</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstance/URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="n">citation_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstance/Citation&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">citation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Title/String&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">citation_dict</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Title/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">citation_dict</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">citation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AlternateTitle/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">citation_dict</span><span class="p">[</span><span class="s1">&#39;AlternateTitle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//AlternateTitle/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">citation_dict</span><span class="p">[</span><span class="s1">&#39;AlternateTitle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;Citation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">citation_dict</span>

    <span class="c1"># Data Relationship Reference</span>
    <span class="n">DataRelationshipRef</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstance/DataRelationshipReference&#39;</span><span class="p">)</span>
    <span class="n">DataRelationshipRef_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">DataRelationshipRef</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">DataRelationshipRef_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataRelationshipRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">DataRelationshipRef_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataRelationshipRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">DataRelationshipRef_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataRelationshipRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">DataRelationshipRef_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataRelationshipRef</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//TypeOfObject&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;DataRelationshipReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataRelationshipRef_dict</span>

    <span class="c1"># DataFileURI</span>
    <span class="n">DataFileURI</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstance/DataFileIdentification/DataFileURI&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">DataFileURI</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;DataFileURI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataFileURI</span><span class="o">.</span><span class="n">text</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;DataFileURI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># GrossFileStructure</span>
    <span class="n">GrossFileStructure_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">GrossFileStructure</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//PhysicalInstance/GrossFileStructure&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">GrossFileStructure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">GrossFileStructure_dict</span><span class="p">[</span><span class="s1">&#39;URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GrossFileStructure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//URN&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">GrossFileStructure_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GrossFileStructure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Agency&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">GrossFileStructure_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GrossFileStructure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">GrossFileStructure_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GrossFileStructure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Version&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">GrossFileStructure_dict</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GrossFileStructure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//UserID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">CreationSoftware</span> <span class="o">=</span> <span class="n">GrossFileStructure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CreationSoftware&#39;</span><span class="p">)</span>
        <span class="n">CreationSoftware_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">CreationSoftware</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">CreationSoftware_dict</span><span class="p">[</span><span class="s1">&#39;SoftwareName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CreationSoftware</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//SoftwareName/String&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">CreationSoftware_dict</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CreationSoftware</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//Description/Content&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">GrossFileStructure_dict</span><span class="p">[</span><span class="s1">&#39;CreationSoftware&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CreationSoftware_dict</span>
        <span class="n">GrossFileStructure_dict</span><span class="p">[</span><span class="s1">&#39;CaseQuantity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GrossFileStructure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.//CaseQuantity&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;GrossFileStructure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GrossFileStructure_dict</span>

    <span class="c1"># Variable Statistics Reference</span>
    <span class="n">VariableStatisticsRef</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//PhysicalInstance/StatisticalSummary/VariableStatisticsReference&quot;</span><span class="p">)</span>

    <span class="n">statistical_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">VariableStatisticsRef</span><span class="p">):</span>
        <span class="n">ref_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Agency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Agency&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//Version&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ref_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//TypeOfObject&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">statistical_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">)</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;VariableStatisticsReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">statistical_list</span>

    <span class="k">return</span> <span class="n">info</span>


<span class="k">def</span> <span class="nf">parse_xml</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="n">item_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used for parsing Item value</span>
<span class="sd">    item_type in:</span>
<span class="sd">        - Series</span>
<span class="sd">        - Study</span>
<span class="sd">        - Metadata Package</span>
<span class="sd">        - Data Collection</span>
<span class="sd">        - Sequence</span>
<span class="sd">        - Statement</span>
<span class="sd">        - Organization</span>
<span class="sd">        - Instrument</span>
<span class="sd">        - Question Group</span>
<span class="sd">        - Concept</span>
<span class="sd">        - Question</span>
<span class="sd">        - Question Grid</span>
<span class="sd">        - Code Set</span>
<span class="sd">        - Interviewer Instruction</span>
<span class="sd">        - Category</span>
<span class="sd">        - Question Activity</span>
<span class="sd">        - Variable Group</span>
<span class="sd">        - Variable</span>
<span class="sd">        - Conditional</span>
<span class="sd">        - Loop</span>
<span class="sd">        - Data File</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">remove_xml_ns</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Series&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_series</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Study&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_study</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Metadata Package&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_metadata_package</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Data Collection&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_data_collection</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Sequence&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_sequence</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Statement&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_statement</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Organization&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_organization</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Instrument&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_instrument</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Question Group&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_question_group</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Concept&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_concept</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Concept Set&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_concept_set</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Question&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_question</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Question Grid&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_question_grid</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Code Set&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_code_set</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Interviewer Instruction&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_interviewer_instruction</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Category&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_category</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Question Activity&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_question_activity</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Variable Group&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_variable_group</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Variable&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_variable</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Conditional&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_conditional</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Loop&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_loop</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;Data File&#39;</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">root_to_dict_data_file</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">return</span> <span class="n">info</span>


<div class="viewcode-block" id="ColecticaObject"><a class="viewcode-back" href="../../module.html#colectica_api.ColecticaObject">[docs]</a><span class="k">class</span> <span class="nc">ColecticaObject</span><span class="p">(</span><span class="n">ColecticaBasicAPI</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ask practical questions to a Colectica server.</span>

<span class="sd">    This extends :class:`ColecticaBasicAPI` by adding additional useful</span>
<span class="sd">    methods.</span>

<span class="sd">    You make a new ColecticaObject by using:</span>

<span class="sd">    &gt;&gt;&gt; C = ColecticaObject(hostname, username, password)</span>

<span class="sd">    If `hostname`, `username` or `password` are omitted, environment</span>
<span class="sd">    variables `COLECTICA_HOSTNAME`, `COLECTICA_USERNAME` and `COLECTICA_PASSWORD`</span>
<span class="sd">    will be used, if they are defined.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ColecticaObject.item_to_dict"><a class="viewcode-back" href="../../module.html#colectica_api.ColecticaObject.item_to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">item_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">,</span> <span class="n">Version</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;From an agency ID and an identifier, get information using ``get_an_item``.</span>

<span class="sd">        Args:</span>
<span class="sd">            AgencyId (str): For example, ``&quot;uk.cls.nextsteps&quot;``.</span>
<span class="sd">            Identifier (str): e.g., ``&quot;a6f96245-5c00-4ad3-89e9-79afaefa0c28&quot;``.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            Version (int/None): if omitted, get the latest version.</span>

<span class="sd">        Return:</span>
<span class="sd">            dict: a dictionary of the item contents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Version</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_an_item</span><span class="p">(</span><span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_an_item_version</span><span class="p">(</span><span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">,</span> <span class="n">Version</span><span class="p">)</span>

        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">item_info</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;ItemType&#39;</span><span class="p">:</span>
                    <span class="n">info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_code_inv</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;Item&#39;</span><span class="p">:</span>
                    <span class="n">item_info</span> <span class="o">=</span> <span class="n">parse_xml</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_code_inv</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;ItemType&#39;</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">item_info</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="ColecticaObject.get_a_set_to_df"><a class="viewcode-back" href="../../module.html#colectica_api.ColecticaObject.get_a_set_to_df">[docs]</a>    <span class="k">def</span> <span class="nf">get_a_set_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AgencyId</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Version</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find all items that are somehow connected to a given item, using ``get_a_set_typed``</span>

<span class="sd">        Args:</span>
<span class="sd">            AgencyId (str):</span>
<span class="sd">            Identifier (str):</span>
<span class="sd">            Version (int):</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas dataframe: with columns [&quot;ItemType&quot;, &quot;Agency&quot;, &quot;Identifier&quot;, &quot;Version&quot;]</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_a_set_typed</span><span class="p">(</span><span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">,</span> <span class="n">Version</span><span class="p">)</span>
        <span class="c1"># print(l)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
             <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">item_code_inv</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;Item2&quot;</span><span class="p">]),</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;Item1&quot;</span><span class="p">][</span><span class="s2">&quot;Item3&quot;</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;Item1&quot;</span><span class="p">][</span><span class="s2">&quot;Item1&quot;</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;Item1&quot;</span><span class="p">][</span><span class="s2">&quot;Item2&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
         <span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ItemType&quot;</span><span class="p">,</span> <span class="s2">&quot;Agency&quot;</span><span class="p">,</span> <span class="s2">&quot;Identifier&quot;</span><span class="p">,</span> <span class="s2">&quot;Version&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="ColecticaObject.item_info_set"><a class="viewcode-back" href="../../module.html#colectica_api.ColecticaObject.item_info_set">[docs]</a>    <span class="k">def</span> <span class="nf">item_info_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find latest version of an item and it&#39;s set</span>

<span class="sd">        Args:</span>
<span class="sd">            AgencyId (str):</span>
<span class="sd">            Identifier (str):</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: A 2-tuple `(df, info)` consisting of a Pandas dataframe of a set</span>
<span class="sd">            and a dict with info about the item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_item_json</span><span class="p">(</span><span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_a_set_to_df</span><span class="p">(</span><span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">info</span></div>

<div class="viewcode-block" id="ColecticaObject.get_question_info"><a class="viewcode-back" href="../../module.html#colectica_api.ColecticaObject.get_question_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_question_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        From a question identifier, get information about </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            AgencyId (str):</span>
<span class="sd">            Identifier (str):</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">question_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_item_xml</span><span class="p">(</span><span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">)</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">remove_xml_ns</span><span class="p">(</span><span class="n">question_info</span><span class="p">[</span><span class="s2">&quot;Item&quot;</span><span class="p">])</span>

        <span class="n">question</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">question_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;ItemType&#39;</span><span class="p">:</span>
                <span class="n">question</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_code_inv</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;Item&#39;</span><span class="p">:</span>
                <span class="n">question</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//UserID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">question</span><span class="p">[</span><span class="s1">&#39;QuestionLabel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//UserAttributePair/AttributeValue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">question</span><span class="p">[</span><span class="s1">&#39;QuestionItemName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//QuestionItemName/String&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">question</span><span class="p">[</span><span class="s1">&#39;QuestionLiteral&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.//QuestionText/LiteralText/Text&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">question</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">question</span></div>


<div class="viewcode-block" id="ColecticaObject.get_question_all"><a class="viewcode-back" href="../../module.html#colectica_api.ColecticaObject.get_question_all">[docs]</a>    <span class="k">def</span> <span class="nf">get_question_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        From a question ID, return question info and it&#39;s response</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            AgencyId (str):</span>
<span class="sd">            Identifier (str):</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas dataframe: with column name [&#39;QuestionURN&#39;, &#39;QuestionItemName&#39;, &#39;response_type&#39;, &#39;Label&#39;, &#39;DateTypeCode&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># print(AgencyId, Identifier)</span>
        <span class="n">question_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_to_dict</span><span class="p">(</span><span class="n">AgencyId</span><span class="p">,</span> <span class="n">Identifier</span><span class="p">)</span>
        <span class="c1"># print(question_info)</span>

        <span class="k">if</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">]</span><span class="o">==</span> <span class="p">{}:</span>
            <span class="n">QI_response_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QI_response_type</span> <span class="o">=</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span>
        <span class="n">question_data</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">],</span>
                            <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionUserID&#39;</span><span class="p">],</span>
                            <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionLabel&#39;</span><span class="p">],</span>
                            <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionItemName&#39;</span><span class="p">],</span>
                            <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionLiteral&#39;</span><span class="p">],</span>
                            <span class="n">QI_response_type</span> <span class="p">]</span> <span class="p">]</span>

        <span class="n">df_question</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">question_data</span><span class="p">,</span>
                                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">,</span> <span class="s1">&#39;QuestionUserID&#39;</span><span class="p">,</span> <span class="s1">&#39;QuestionLabel&#39;</span><span class="p">,</span> <span class="s1">&#39;QuestionItemName&#39;</span><span class="p">,</span> 
                                            <span class="s1">&#39;QuestionLiteral&#39;</span><span class="p">,</span> <span class="s1">&#39;response_type&#39;</span><span class="p">])</span>

        <span class="c1"># instruction</span>
        <span class="k">if</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Instruction&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="p">{}:</span>
            <span class="n">instruction_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_to_dict</span><span class="p">(</span><span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Instruction&#39;</span><span class="p">][</span><span class="s1">&#39;Agency&#39;</span><span class="p">],</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Instruction&#39;</span><span class="p">][</span><span class="s1">&#39;ID&#39;</span><span class="p">])</span>
            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;Instruction_URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instruction_dict</span><span class="p">[</span><span class="s1">&#39;InstructionURN&#39;</span><span class="p">]</span>
            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;Instruction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instruction_dict</span><span class="p">[</span><span class="s1">&#39;InstructionText&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;Instruction_URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;Instruction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">QI_response_type</span> <span class="o">==</span> <span class="s1">&#39;CodeList&#39;</span><span class="p">:</span>
            <span class="n">code_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_to_dict</span><span class="p">(</span><span class="n">AgencyId</span><span class="p">,</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;CodeList_ID&#39;</span><span class="p">])</span>
            <span class="n">code_list_sourceId</span> <span class="o">=</span> <span class="n">code_result</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">]</span>
            <span class="n">code_list_label</span> <span class="o">=</span> <span class="n">code_result</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span>

            <span class="n">code_list</span> <span class="o">=</span> <span class="n">code_result</span><span class="p">[</span><span class="s1">&#39;Code&#39;</span><span class="p">]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Label&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">code_list</span><span class="p">:</span>
                <span class="n">category_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_to_dict</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;CategoryReference&#39;</span><span class="p">][</span><span class="s1">&#39;Agency&#39;</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;CategoryReference&#39;</span><span class="p">][</span><span class="s1">&#39;ID&#39;</span><span class="p">])</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;response_type&#39;</span><span class="p">:</span> <span class="s1">&#39;CodeList&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span>
                                         <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="n">category_dict</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="n">category_dict</span><span class="p">[</span><span class="s1">&#39;UserID&#39;</span><span class="p">],</span>
                                        <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="n">category_dict</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span>
                               <span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;code_list_URN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;code_list_URN&#39;</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;code_list_sourceId&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_list_sourceId</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;code_list_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_list_label</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">]</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;QuestionItemName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionItemName&#39;</span><span class="p">]</span>

            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_list_label</span>
            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;response_domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;code_list_URN&#39;</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">QI_response_type</span> <span class="o">==</span> <span class="s1">&#39;Text&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionItemName&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_type&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_label&#39;</span><span class="p">]</span> <span class="p">]</span> <span class="p">]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">,</span> <span class="s1">&#39;QuestionItemName&#39;</span><span class="p">,</span> <span class="s1">&#39;response_type&#39;</span><span class="p">,</span> <span class="s1">&#39;Label&#39;</span><span class="p">])</span>

            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_label&#39;</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">QI_response_type</span> <span class="o">==</span> <span class="s1">&#39;Numeric&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionItemName&#39;</span><span class="p">],</span> 
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_type&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_label&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_NumericType&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_RangeLow&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_RangeHigh&#39;</span><span class="p">]</span> <span class="p">]</span> <span class="p">]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">,</span> <span class="s1">&#39;QuestionItemName&#39;</span><span class="p">,</span> <span class="s1">&#39;response_type&#39;</span><span class="p">,</span> <span class="s1">&#39;Label&#39;</span><span class="p">,</span> <span class="s1">&#39;response_NumericType&#39;</span><span class="p">,</span> <span class="s1">&#39;response_RangeLow&#39;</span><span class="p">,</span> <span class="s1">&#39;response_RangeHigh&#39;</span><span class="p">])</span>

            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_label&#39;</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">QI_response_type</span> <span class="o">==</span> <span class="s1">&#39;DateTime&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;QuestionItemName&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_type&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_label&#39;</span><span class="p">],</span>
                       <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;DateTypeCode&#39;</span><span class="p">]</span> <span class="p">]</span> <span class="p">]</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;QuestionURN&#39;</span><span class="p">,</span> <span class="s1">&#39;QuestionItemName&#39;</span><span class="p">,</span> <span class="s1">&#39;response_type&#39;</span><span class="p">,</span> <span class="s1">&#39;Label&#39;</span><span class="p">,</span> <span class="s1">&#39;DateTypeCode&#39;</span><span class="p">])</span>

            <span class="n">df_question</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">][</span><span class="s1">&#39;response_label&#39;</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">QI_response_type</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">question_info</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">])</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">df_question</span><span class="p">,</span> <span class="n">df</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;don&#39;t run this directly&quot;</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 Jenny Li.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>